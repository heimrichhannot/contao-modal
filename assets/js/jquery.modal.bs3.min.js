!function(t){var a={init:function(){this.bindToggle(),this.bindClose(),this.bindPopState(),t(document).ajaxComplete(t.proxy(this.ajaxComplete,this))},ajaxComplete:function(){this.bindClose(!0)},bindToggle:function(){t("body").on("click","[data-toggle=modal]",function(){var a=t(this),o=a.attr("href"),e=HASTE_PLUS.getParameterByName("ag",o);if("modal"!=a.data("event")&&"modal"!=a.data("news")&&"modal"!=a.data("job")){void 0===o&&(o=a.attr("xlink:href"));var i=o||a.data("target");if("modal"!=e){if(t(i).length>0)return;return window.location.href=o,!1}return void 0!==o&&(t.ajax({url:o,data:{location:window.location.href},dataType:"json",error:function(t,a,o){if(300==t.status)return location.href=t.responseJSON.result.data.url,void closeModal(t.responseJSON,$form)},success:function(a,o,e){if(void 0!==a&&a.result.html&&a.result.data.id){var i=t(a.result.html);t("body").find(".bs-modal").remove(),i.appendTo("body");var n=t(".bs-modal");n.modal("show"),document.dispatchEvent(new CustomEvent("modalAjaxComplete",{detail:n,bubbles:!0,cancelable:!0})),void 0!==a.result.data.url&&window.history&&window.history.pushState&&history.pushState({},null,a.result.data.url)}}}),!1)}})},bindClose:function(a){t(".bs-modal").on("hide.bs.modal",function(a){var o=t(this);o.find("iframe").each(function(){var a=t(this);"string"==typeof a.attr("src")&&a.attr("src",a.attr("src").replace("autoplay=1","autoplay=0"))}),o.find("audio, video").each(function(){this.pause()}),window.history&&window.history.pushState&&history.pushState({},null,o.data("back"))})},bindPopState:function(){t(window).on("popstate",function(){t(".bs-modal").modal("hide")})}};t(function(){a.init()})}(jQuery);
