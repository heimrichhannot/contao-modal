!function(a){var b={init:function(){this.bindToggle(),this.bindClose(),this.bindPopState(),a(document).ajaxComplete(a.proxy(this.ajaxComplete,this))},ajaxComplete:function(){this.bindClose(!0)},bindToggle:function(){a("body").on("click","[data-toggle=modal]",function(){var b=a(this),c=b.attr("href"),d=HASTE_PLUS.getParameterByName("ag",c);if("modal"!=b.data("event")&&"modal"!=b.data("news"))return void 0===c&&(c=b.attr("xlink:href")),"modal"!=d?(window.location.href=c,!1):void 0!==c&&(a.ajax({url:c,data:{location:window.location.href},dataType:"json",error:function(a,b,c){if(300==a.status)return location.href=a.responseJSON.result.data.url,void closeModal(a.responseJSON,$form)},success:function(b,c,d){if(void 0!==b&&b.result.html&&b.result.data.id){var e=a(b.result.html);a("body").find(".bs-modal").remove(),e.appendTo("body").modal("show"),void 0!==b.result.data.url&&window.history&&window.history.pushState&&history.pushState({},null,b.result.data.url)}}}),!1)})},bindClose:function(b){a(".bs-modal").on("hide.bs.modal",function(b){var c=a(this);c.find("iframe").each(function(){var b=a(this);b.attr("src",b.attr("src").replace("autoplay=1","autoplay=0"))}),c.find("audio, video").each(function(){this.pause()}),window.history&&window.history.pushState&&history.pushState({},null,c.data("back"))})},bindPopState:function(){a(window).on("popstate",function(){a(".bs-modal").modal("hide")})}};a(function(){b.init()})}(jQuery);