!function(t){var o={init:function(){this.bindToggle(),this.bindToggleInitially(),this.bindClose(),this.bindPopState(),t(document).ajaxComplete(t.proxy(this.ajaxComplete,this))},ajaxComplete:function(){this.bindClose(!0)},bindToggleInitially:function(){t(".modal.show").modal({show:!0})},bindToggle:function(){t("body").on("click","[data-toggle=modal]",function(){var o=t(this),a=o.attr("href"),i=HASTE_PLUS.getParameterByName("ag",a);if("modal"!=o.data("event")&&"modal"!=o.data("news")&&"modal"!=o.data("job")){void 0===a&&(a=o.attr("xlink:href"));var n=a||o.data("target");if("modal"!=i){if(t(n).length>0)return;return window.location.href=a,!1}return void 0!==a&&(t.ajax({url:a,data:{location:window.location.href},dataType:"json",error:function(t,o,a){if(300==t.status)return location.href=t.responseJSON.result.data.url,void closeModal(t.responseJSON,$form)},success:function(o,a,i){if(void 0!==o&&o.result.html&&o.result.data.id){var n=t(o.result.html);t("body").find(".bs-modal").remove(),n.appendTo("body");var e=t(".bs-modal");e.modal("show"),document.dispatchEvent(new CustomEvent("modalAjaxComplete",{detail:e,bubbles:!0,cancelable:!0})),void 0!==o.result.data.url&&window.history&&window.history.pushState&&history.pushState({},null,o.result.data.url)}}}),!1)}})},bindClose:function(o){t(".bs-modal").on("hide.bs.modal",function(o){var a=t(this);a.find("iframe").each(function(){var o=t(this);"string"==typeof o.attr("src")&&o.attr("src",o.attr("src").replace("autoplay=1","autoplay=0"))}),a.find("audio, video").each(function(){this.pause()}),window.history&&window.history.pushState&&history.pushState({},null,a.data("back"))})},bindPopState:function(){t(window).on("popstate",function(){t(".bs-modal").modal("hide")})}};t(function(){o.init()})}(jQuery);
